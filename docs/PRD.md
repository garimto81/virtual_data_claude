# 📋 Virtual Data - 포커 핸드 로거 PRD
> Product Requirements Document v3.5.32
> 최종 업데이트: 2025-10-04

---

## 📌 문서 개요

### 목적
본 문서는 Virtual Data 포커 핸드 로거의 제품 요구사항을 정의하고, 개발 방향성과 우선순위를 명확히 합니다.

### 범위
- 제품 비전 및 목표
- 기능 요구사항 (Functional Requirements)
- 비기능 요구사항 (Non-Functional Requirements)
- 사용자 스토리 및 시나리오
- 성공 지표 (Success Metrics)

---

## 🎯 제품 비전

### 비전 선언문
**실시간 포커 게임 데이터를 완벽하게 추적하고 분석하여, 플레이어의 성과 향상과 게임 운영 최적화를 지원하는 차세대 웹 기반 포커 핸드 로깅 플랫폼**

### 핵심 가치 제안
1. **실시간성** - 모든 액션이 즉시 반영되는 제로 지연 시스템
2. **정확성** - 100% 정확한 데이터 기록 및 검증
3. **접근성** - 설치 불필요, 웹 브라우저만으로 즉시 사용
4. **협업성** - Google Sheets 연동으로 팀 분석 및 데이터 공유

### 목표 사용자
| 사용자 그룹 | 니즈 | 제공 가치 |
|-----------|------|----------|
| **온라인 포커 플레이어** | 핸드 히스토리 분석, 실수 패턴 파악 | 실시간 액션 기록, 통계 분석 |
| **포커 게임 운영자** | 게임 모니터링, 플레이어 관리 | 멀티테이블 관리, 칩 추적 |
| **포커 코치** | 학생 플레이 분석, 교육 자료 생성 | 상세 핸드 기록, 액션 순서 분석 |
| **포커 커뮤니티** | 핸드 리뷰, 전략 토론 | 데이터 공유, 협업 분석 |

---

## 🔑 핵심 기능 요구사항

### F1. 핸드 기록 시스템 (Phase Complete ✅)

#### F1.1 실시간 액션 기록
- **요구사항**: 프리플랍, 플랍, 턴, 리버 각 스트릿별 액션 실시간 기록
- **우선순위**: P0 (필수)
- **현재 상태**: ✅ 구현 완료
- **세부 기능**:
  - [x] 폴드, 콜, 레이즈, 체크, 올인 액션 지원
  - [x] 베팅 금액 자동 계산 및 팟 추적
  - [x] 액션 순서 자동 관리 (ActionOrderManagerV2)
  - [x] 스마트 Check/Call 버튼 (컨텍스트 인식)
  - [x] 실행취소 기능 (최근 20개 액션)

#### F1.2 플레이어 관리
- **요구사항**: 테이블별 플레이어 등록, 수정, 삭제
- **우선순위**: P0 (필수)
- **현재 상태**: ✅ 구현 완료
- **세부 기능**:
  - [x] 10개 고정 시트 시스템
  - [x] IN/OUT 상태 관리
  - [x] 좌석 번호 자동/수동 할당
  - [x] 칩 스택 실시간 추적
  - [x] 국가 정보 매핑
  - [x] 중복 플레이어 자동 제거

#### F1.3 보드 카드 입력
- **요구사항**: 플랍, 턴, 리버 커뮤니티 카드 입력
- **우선순위**: P0 (필수)
- **현재 상태**: ✅ 구현 완료
- **세부 기능**:
  - [x] 비주얼 카드 선택 UI
  - [x] 스트릿별 자동 진행
  - [x] 카드 수정 기능
  - [x] 입력 상태 표시

### F2. 데이터 저장 및 동기화

#### F2.1 Google Sheets 연동
- **요구사항**: Google Sheets를 데이터베이스로 활용
- **우선순위**: P0 (필수)
- **현재 상태**: ✅ 구현 완료 (Apps Script v71.0.3)
- **세부 기능**:
  - [x] Type 시트 (플레이어 정보, 8컬럼)
  - [x] Index 시트 (핸드 메타데이터)
  - [x] Hand 시트 (상세 액션 기록)
  - [x] Config 시트 (설정 저장)
  - [x] PlayerIndex 클래스 기반 고속 검색

#### F2.2 실시간 동기화
- **요구사항**: 모든 변경사항 즉시 동기화
- **우선순위**: P1 (중요)
- **현재 상태**: ✅ 구현 완료
- **세부 기능**:
  - [x] API 재시도 메커니즘 (최대 3회, 지수 백오프)
  - [x] 네트워크 오류 처리
  - [x] 오프라인 지원 (IndexedDB)
  - [x] 자동 재연결

### F3. 모바일 최적화 (Phase 3 Complete ✅)

#### F3.1 터치 인터페이스
- **요구사항**: 모바일 기기에서 완벽한 UX 제공
- **우선순위**: P0 (필수)
- **현재 상태**: ✅ 구현 완료
- **세부 기능**:
  - [x] 44x44px 최소 터치 영역
  - [x] 터치 응답 시간 < 50ms
  - [x] 스와이프 제스처 (실행취소)
  - [x] 롱프레스 컨텍스트 메뉴
  - [x] 햅틱 피드백

#### F3.2 성능 최적화
- **요구사항**: 모바일 환경에서 원활한 성능
- **우선순위**: P1 (중요)
- **현재 상태**: ✅ 구현 완료
- **세부 기능**:
  - [x] 가상 스크롤 (1000개+ 아이템)
  - [x] 메모리 관리 (자동 정리)
  - [x] 이미지 레이지 로딩

### F4. 보안 및 안정성 (Phase 4 진행 중 ⚠️)

#### F4.1 API 보호 시스템
- **요구사항**: 견고한 API 호출 보호
- **우선순위**: P0 (필수)
- **현재 상태**: ⚠️ 코드 완료, 사용자 검증 필요
- **세부 기능**:
  - [x] Apps Script URL 검증
  - [x] 재시도 로직 (지수 백오프)
  - [x] 타임아웃 처리 (30초)
  - [x] 사용자 친화적 에러 메시지
  - [ ] 실제 환경 검증 완료

#### F4.2 데이터 무결성
- **요구사항**: 데이터 정확성 보장
- **우선순위**: P0 (필수)
- **현재 상태**: ✅ 구현 완료
- **세부 기능**:
  - [x] 입력 검증
  - [x] 중복 제거 (Phase 5)
  - [x] 트랜잭션 처리
  - [x] 자동 정렬

---

## 🚀 비기능 요구사항

### NFR1. 성능 요구사항
| 지표 | 목표 | 현재 | 상태 |
|-----|------|------|------|
| 페이지 로드 시간 | < 2초 | ~1.5초 | ✅ |
| API 응답 시간 | < 500ms | ~300ms | ✅ |
| 터치 반응 속도 | < 50ms | ~5ms | ✅ |
| 동시 사용자 | 100명 | 10명 | ❌ |

### NFR2. 확장성
- **데이터베이스**: 현재 Google Sheets (제한적)
- **동시성**: Apps Script 제약 (6분/요청)
- **스토리지**: 무제한 (Google Drive)
- **향후 계획**: PostgreSQL 마이그레이션

### NFR3. 호환성
- **브라우저**: Chrome 90+, Safari 14+, Firefox 88+
- **모바일**: iOS 14+, Android 10+
- **화면 크기**: 320px ~ 4K 지원
- **네트워크**: 2G ~ 5G 최적화

### NFR4. 보안
- **인증**: Google OAuth 2.0 (향후)
- **데이터 전송**: HTTPS 필수
- **권한 관리**: Apps Script 권한 제어
- **민감 정보**: Script Properties 저장

---

## 👥 사용자 스토리

### Epic 1: 핸드 기록
```
AS A 포커 플레이어
I WANT TO 실시간으로 핸드 액션을 기록하고
SO THAT 나중에 플레이를 분석할 수 있다

인수 조건:
- [ ] 모든 스트릿 액션이 정확히 기록됨
- [ ] 팟 사이즈가 자동으로 계산됨
- [ ] 승자가 명확히 표시됨
- [ ] Google Sheets에 즉시 저장됨
```

### Epic 2: 플레이어 관리
```
AS A 게임 운영자
I WANT TO 테이블별 플레이어를 효율적으로 관리하고
SO THAT 게임 진행을 원활하게 할 수 있다

인수 조건:
- [ ] 플레이어 추가/삭제가 1초 이내 완료
- [ ] 칩 스택이 실시간 업데이트됨
- [ ] IN/OUT 상태가 명확히 표시됨
- [ ] 중복 플레이어가 자동 제거됨
```

### Epic 3: 모바일 사용
```
AS A 모바일 사용자
I WANT TO 스마트폰에서 편리하게 핸드를 기록하고
SO THAT 데스크톱 없이도 작업할 수 있다

인수 조건:
- [ ] 모든 버튼이 터치하기 쉬움 (44px+)
- [ ] 스와이프로 실행취소 가능
- [ ] 오프라인에서도 작동
- [ ] 온라인 복구 시 자동 동기화
```

---

## 📊 성공 지표 (Success Metrics)

### 제품 지표
| KPI | 목표 | 측정 방법 |
|-----|------|----------|
| **일일 활성 사용자 (DAU)** | 100명 | Google Analytics |
| **핸드 기록 완료율** | 95% | 시작 vs 완료 비율 |
| **평균 세션 시간** | 30분 | Analytics |
| **오류 발생률** | < 1% | Sentry 모니터링 |

### 기술 지표
| KPI | 목표 | 현재 |
|-----|------|------|
| **API 성공률** | 99% | 95% |
| **평균 응답 시간** | < 300ms | ~300ms |
| **모바일 성능 점수** | 90+ | 85 |
| **코드 커버리지** | 80% | 0% |

### 사용자 만족도
- **NPS (Net Promoter Score)**: 목표 50+
- **CSAT (Customer Satisfaction)**: 목표 4.5/5.0
- **피드백 응답률**: 목표 80%

---

## 🗓️ 로드맵

### Phase 0-3: 완료 ✅
- [x] 기본 핸드 기록 시스템
- [x] Google Sheets 연동
- [x] 모바일 최적화
- [x] 액션 순서 자동 관리

### Phase 4: API 보호 (진행 중 ⚠️)
- [x] 코드 구현 완료
- [ ] 사용자 검증
- [ ] 프로덕션 배포

### Phase 5: 중복 제거 (완료 ✅)
- [x] 자동 실행 제거
- [x] 수동 실행 시스템
- [x] UX 개선

### Phase 6: 향후 계획 (백로그)
- [ ] PostgreSQL 마이그레이션
- [ ] WebSocket 실시간 통신
- [ ] AI 기반 플레이 분석
- [ ] 다국어 지원
- [ ] PWA 완성

---

## ⚠️ 제약사항 및 리스크

### 기술적 제약
1. **Google Apps Script 제한**
   - 실행 시간: 6분/요청
   - 일일 쿼터: 제한적
   - 동시 사용자: ~10명
   - **완화 방안**: PostgreSQL 마이그레이션 계획

2. **브라우저 제약**
   - IndexedDB 스토리지 제한
   - 메모리 제약 (모바일)
   - **완화 방안**: 데이터 압축, 페이지네이션

### 운영 리스크
1. **데이터 유실 위험**
   - **영향도**: 높음
   - **완화**: 자동 백업, 버전 관리

2. **보안 취약점**
   - **영향도**: 중간
   - **완화**: Script Properties 사용, 입력 검증

---

## 📝 변경 이력

| 날짜 | 버전 | 변경 내용 | 작성자 |
|-----|------|----------|--------|
| 2025-10-04 | 3.5.32 | 21개 문서 통합, PRD 최초 작성 | Claude |
| 2025-09-24 | 3.5.0 | Phase 5 완료 반영 | - |
| 2025-09-23 | 3.4.25 | Phase 4 진행 상황 반영 | - |

---

**다음 업데이트 예정일**: 기능 추가/변경 시 즉시 업데이트

# 시스템 구성 요소

## 1. 하드웨어 구성

### 1.1 제어 패널
#### 상태 표시 패널 (1열)
```
┌─────────────────────────────────────┐
│  [D]  [1]  [2]  [3]  [4]  [5]  [6] │  D: 딜러
│  ●    ○    ●    ○    ○    ●    ○   │  ●: 활성
│                                     │  ○: 비활성
└─────────────────────────────────────┘
```

**사양**
- LED 버튼: RGB LED, 1000cd/m²
- 크기: 50mm x 50mm
- 간격: 10mm
- 응답 시간: < 5ms

#### 액션 제어 패널 (4열)
```
┌─────────────────────────────────────┐
│  [CALL]  [RAISE]  [FOLD]  [UNDO]   │
│  [CHECK] [BET]    [ALLIN] [RESET]  │
└─────────────────────────────────────┘
```

**사양**
- 기계식 스위치: Cherry MX Blue
- 내구성: 5천만 회 클릭
- 촉각 피드백: 60g 작동력
- 백라이트: RGB LED

### 1.2 메인 컨트롤러
#### 하드웨어 사양
- CPU: Intel i7-12700K
- RAM: 32GB DDR4
- Storage: 1TB NVMe SSD
- Network: 10Gb Ethernet
- OS: Ubuntu 22.04 LTS

#### I/O 인터페이스
- USB 3.0 x 8 (제어 패널)
- HDMI 2.1 x 4 (모니터)
- Ethernet x 2 (이중화)
- GPIO x 24 (확장)

### 1.3 네트워크 장비
#### 주요 구성
- 코어 스위치: Cisco Catalyst 9300
- 방화벽: Fortinet FortiGate
- 로드 밸런서: F5 BIG-IP

## 2. 소프트웨어 구성

### 2.1 운영체제 및 런타임
#### 시스템 소프트웨어
```yaml
OS: Ubuntu 22.04 LTS
Runtime:
  - Node.js 18.x
  - Python 3.10
  - Go 1.20
Database:
  - PostgreSQL 15
  - Redis 7.0
  - InfluxDB 2.0
```

### 2.2 핵심 서비스
#### Game State Service
```typescript
class GameStateService {
  private state: GameState;
  private subscribers: Subscriber[];
  
  updateState(action: Action): void {
    // 상태 업데이트 로직
    this.validateAction(action);
    this.applyAction(action);
    this.notifySubscribers();
  }
}
```

**주요 기능**
- 게임 상태 관리
- 규칙 검증
- 이벤트 발행

#### Action Processing Service
```typescript
class ActionProcessor {
  private queue: ActionQueue;
  private validator: ActionValidator;
  
  async processAction(action: Action): Promise<Result> {
    await this.validator.validate(action);
    return await this.queue.enqueue(action);
  }
}
```

**주요 기능**
- 액션 큐 관리
- 입력 검증
- 비동기 처리

#### Algorithm Engine
```typescript
class LastAggressorAlgorithm {
  private aggressor: Player | null;
  private betHistory: BetAction[];
  
  updateAggressor(action: BetAction): void {
    if (this.isAggressiveAction(action)) {
      this.aggressor = action.player;
      this.betHistory.push(action);
    }
  }
}
```

**주요 기능**
- Last Aggressor 추적
- 베팅 패턴 분석
- 자동 진행 결정

### 2.3 데이터베이스 스키마
#### 주요 테이블
```sql
-- 게임 세션
CREATE TABLE game_sessions (
  id UUID PRIMARY KEY,
  table_id INTEGER NOT NULL,
  started_at TIMESTAMP NOT NULL,
  ended_at TIMESTAMP,
  status VARCHAR(20) NOT NULL
);

-- 플레이어 상태
CREATE TABLE player_states (
  session_id UUID REFERENCES game_sessions(id),
  seat_number INTEGER NOT NULL,
  status VARCHAR(20) NOT NULL,
  stack_size DECIMAL(10,2),
  PRIMARY KEY (session_id, seat_number)
);

-- 액션 로그
CREATE TABLE action_logs (
  id BIGSERIAL PRIMARY KEY,
  session_id UUID REFERENCES game_sessions(id),
  timestamp TIMESTAMP NOT NULL,
  action_type VARCHAR(20) NOT NULL,
  player_seat INTEGER,
  details JSONB
);
```

## 3. 통합 컴포넌트

### 3.1 카메라 제어 시스템
#### 지원 프로토콜
- VISCA over IP
- NDI
- RTSP
- Blackmagic SDI

#### 카메라 프리셋
```json
{
  "presets": {
    "overview": { "pan": 0, "tilt": 0, "zoom": 1 },
    "seat_1": { "pan": -30, "tilt": -10, "zoom": 3 },
    "seat_2": { "pan": -15, "tilt": -10, "zoom": 3 },
    // ... 더 많은 프리셋
  }
}
```

### 3.2 오디오 시스템
#### 오디오 매트릭스
- 입력: 16채널 (각 좌석 + 딜러 + 앰비언트)
- 출력: 8채널 (방송 + 모니터링)
- 처리: DSP 기반 노이즈 제거

### 3.3 외부 시스템 연동
#### API Gateway
```yaml
endpoints:
  - path: /api/v1/game/state
    method: GET
    auth: bearer
  - path: /api/v1/game/action
    method: POST
    auth: bearer
  - path: /api/v1/stats
    method: GET
    auth: api_key
```

#### 지원 통합
- OBS Studio (방송 소프트웨어)
- Wirecast (라이브 프로덕션)
- 통계 분석 시스템
- 베팅 플랫폼

## 4. 모니터링 및 관리

### 4.1 시스템 모니터링
#### 메트릭 수집
```yaml
metrics:
  - name: system_latency
    type: histogram
    unit: milliseconds
  - name: action_count
    type: counter
    labels: [action_type, result]
  - name: active_sessions
    type: gauge
```

### 4.2 로깅 시스템
#### 로그 레벨
- ERROR: 시스템 오류
- WARN: 경고 상황
- INFO: 일반 정보
- DEBUG: 디버깅 정보

### 4.3 백업 및 복구
#### 백업 정책
- 실시간: 상태 스냅샷 (1분 간격)
- 일일: 전체 데이터베이스
- 주간: 시스템 이미지
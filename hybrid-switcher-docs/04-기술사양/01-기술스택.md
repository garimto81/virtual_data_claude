# 기술 스택

## 1. 백엔드 기술

### 1.1 핵심 서버
#### Node.js (v18.x LTS)
- **선택 이유**: 실시간 이벤트 처리, 비동기 I/O
- **주요 프레임워크**: Express.js, Socket.io
- **패키지 관리**: npm, yarn

```json
{
  "dependencies": {
    "express": "^4.18.2",
    "socket.io": "^4.6.1",
    "redis": "^4.6.5",
    "postgresql": "^1.7.1",
    "winston": "^3.9.0"
  }
}
```

#### Go (v1.20)
- **용도**: 고성능 마이크로서비스
- **주요 모듈**: 
  - Camera Control Service
  - Algorithm Engine
  - Real-time Analytics

### 1.2 데이터베이스
#### PostgreSQL 15
- **용도**: 주요 데이터 저장소
- **특징**: 
  - ACID 트랜잭션
  - JSON 지원
  - 고성능 인덱싱

#### Redis 7.0
- **용도**: 캐싱, 세션 관리, Pub/Sub
- **구성**: 
  - Master-Slave 복제
  - Sentinel 고가용성

#### InfluxDB 2.0
- **용도**: 시계열 데이터, 메트릭
- **수집 데이터**:
  - 시스템 성능
  - 게임 통계
  - 사용자 활동

### 1.3 메시징 시스템
#### RabbitMQ
```yaml
exchanges:
  - name: game_events
    type: topic
    durable: true
  
queues:
  - name: action_queue
    durable: true
    arguments:
      x-message-ttl: 60000
  
bindings:
  - exchange: game_events
    queue: action_queue
    routing_key: "game.action.*"
```

## 2. 프론트엔드 기술

### 2.1 UI 프레임워크
#### React 18
- **선택 이유**: 컴포넌트 기반, 가상 DOM
- **상태 관리**: Redux Toolkit
- **스타일링**: Styled Components

```typescript
// 컴포넌트 예시
const StatusButton: React.FC<ButtonProps> = ({ 
  seat, 
  status, 
  onClick 
}) => {
  return (
    <StyledButton
      status={status}
      onClick={() => onClick(seat)}
    >
      <LEDIndicator active={status === 'active'} />
      <SeatNumber>{seat}</SeatNumber>
    </StyledButton>
  );
};
```

### 2.2 실시간 통신
#### WebSocket (Socket.io)
```javascript
// 클라이언트 연결
const socket = io('wss://switcher.example.com', {
  transports: ['websocket'],
  reconnection: true,
  reconnectionDelay: 1000
});

// 이벤트 핸들링
socket.on('gameState', (state) => {
  updateUI(state);
});

socket.emit('action', {
  type: 'CALL',
  player: 3,
  amount: 100
});
```

### 2.3 시각화
#### D3.js
- **용도**: 실시간 차트, 통계 시각화
- **구현**: 
  - 팟 사이즈 그래프
  - 플레이어 통계
  - 시스템 메트릭

## 3. 하드웨어 인터페이스

### 3.1 USB HID 통신
```cpp
// C++ 하드웨어 인터페이스
class ButtonController {
private:
    hid_device* device;
    
public:
    void initialize() {
        device = hid_open(VENDOR_ID, PRODUCT_ID, NULL);
    }
    
    void setLED(int button, LEDState state) {
        unsigned char buf[65];
        buf[0] = 0x01; // Report ID
        buf[1] = button;
        buf[2] = state.color;
        buf[3] = state.pattern;
        hid_write(device, buf, 65);
    }
};
```

### 3.2 카메라 제어
#### NDI SDK
```python
# Python NDI 인터페이스
import NDIlib as ndi

class CameraController:
    def __init__(self):
        self.finder = ndi.find_create_v2()
        self.sources = []
        
    def switch_camera(self, source_name):
        source = self.find_source(source_name)
        if source:
            self.receiver.connect(source)
            
    def apply_preset(self, preset_id):
        ptz_cmd = {
            'pan': presets[preset_id]['pan'],
            'tilt': presets[preset_id]['tilt'],
            'zoom': presets[preset_id]['zoom']
        }
        self.send_ptz_command(ptz_cmd)
```

## 4. DevOps 및 인프라

### 4.1 컨테이너화
#### Docker
```dockerfile
# 멀티 스테이지 빌드
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

FROM node:18-alpine
WORKDIR /app
COPY --from=builder /app/node_modules ./node_modules
COPY . .
EXPOSE 3000
CMD ["node", "server.js"]
```

#### Kubernetes
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: switcher-backend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: switcher
  template:
    metadata:
      labels:
        app: switcher
    spec:
      containers:
      - name: backend
        image: switcher:latest
        ports:
        - containerPort: 3000
        resources:
          requests:
            memory: "256Mi"
            cpu: "500m"
          limits:
            memory: "512Mi"
            cpu: "1000m"
```

### 4.2 CI/CD
#### GitLab CI/CD
```yaml
stages:
  - test
  - build
  - deploy

test:
  stage: test
  script:
    - npm test
    - npm run lint
    - npm run type-check

build:
  stage: build
  script:
    - docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA .
    - docker push $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA

deploy:
  stage: deploy
  script:
    - kubectl set image deployment/switcher-backend backend=$CI_REGISTRY_IMAGE:$CI_COMMIT_SHA
```

### 4.3 모니터링
#### Prometheus + Grafana
```yaml
# Prometheus 설정
scrape_configs:
  - job_name: 'switcher'
    static_configs:
      - targets: ['switcher:9090']
    metrics_path: '/metrics'
    scrape_interval: 5s
```

#### ELK Stack
- **Elasticsearch**: 로그 저장 및 검색
- **Logstash**: 로그 수집 및 처리
- **Kibana**: 로그 시각화 및 분석

## 5. 보안 기술

### 5.1 인증/인가
#### JWT + OAuth2
```javascript
// JWT 미들웨어
const authenticateToken = (req, res, next) => {
  const authHeader = req.headers['authorization'];
  const token = authHeader && authHeader.split(' ')[1];
  
  if (!token) {
    return res.sendStatus(401);
  }
  
  jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (err, user) => {
    if (err) return res.sendStatus(403);
    req.user = user;
    next();
  });
};
```

### 5.2 암호화
- **TLS 1.3**: 모든 통신 암호화
- **AES-256**: 데이터 저장 시 암호화
- **bcrypt**: 비밀번호 해싱

## 6. 개발 도구

### 6.1 IDE 및 에디터
- Visual Studio Code
- JetBrains IDEs
- Vim/Neovim

### 6.2 디버깅 도구
- Chrome DevTools
- Postman
- Wireshark

### 6.3 성능 분석
- New Relic
- AppDynamics
- JMeter